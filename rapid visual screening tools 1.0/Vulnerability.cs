using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace rapid_visual_screening_tools_1._0
{
    public partial class frmVulnerability : Form
    {
        public frmVulnerability()
        {
            InitializeComponent();
        }

        public const int itemnum = 41;
        const int choicenum = 10;
        const int errornum = 2;
        public static Label[] name = new Label[itemnum];
        public static ComboBox[] choice = new ComboBox[itemnum];
        public static TextBox[,] txt = new TextBox[itemnum, 9];
        public static TextBox[] sumvul = new TextBox[9];
        public static double[] sumvuldata = new double[9];
        public static Label[] lblmentary = new Label[itemnum];
        public static ToolTip[] ttp = new ToolTip[itemnum];
        Label[] labelerror = new Label[errornum];

        //数据项目输入
        string[] nameitem = new string[itemnum]
        { "3.1 与未知车辆的距离", "3.2 场地周界", "3.3 无阻碍视线距离(ft)",
        "3.4 未知安全性的地下通道通达性","3.5 危险材料储存","3.6 临近地上/地下结构物",
        "4.1建筑高度",
        "4.2 建筑面积/占地面积",
        "4.3 建筑形状","4.4 悬挑长度","4.5 公共区域与主体结构位置关系","4.6 装卸货区与主体结构位置关系",
        "4.7 防止车辆小角度冲撞措施","4.8 车库位置","5.1 玻璃支撑类型","5.2 玻璃夹持深度",
        "5.3 窗墙面积比","5.4 玻璃类型","5.5 墙体类型","5.6风载碎片防护设计",
        "6.1 结构类型","6.2 短边方向隔间数量","6.3 柱距(ft)","6.4 柱高","6.5 公共区域柱",
        "6.6 转换梁","6.7 其他有利/不利设计","7.1 新风进气系统位置","7.2 回风进气系统形式","7.3 空气分配系统设计",
        "7.4 靠近高风险区域的关键公用设施","8.1.1.1 侦测系统数量","8.1.1.2整体安保系统效用",
        "8.1.2.1 侦测系统数量","8.1.2.2整体安保系统效用",
        "8.1.3.1 侦测系统数量","8.1.3.2整体安保系统效用",
        "8.2.1.1 侦测系统数量","8.2.1.2整体安保系统效用",
        "8.2.2.1 侦测系统数量","8.2.2.2整体安保系统效用"};
        string[,] choiceitem = new string[itemnum, choicenum]
        {
            { "≥25","15-25","7.5-15","1.5-7.5","＜1.5","","","","",""},
            { "连续型防撞障碍","有效的防撞设计","利用环境设计预防犯罪","装饰性/临时性/防攀爬栅栏","无安全设计","","","","",""},
            {"≥9","6-9","3-6","1.5-3","＜1.5","","","","","" },
            {"无","能够到达场地的多用隧道或涵洞","能够到达建筑的多用隧道","能够到达建筑的人行隧道","","","","","",""},
            {"无","较少","中等","较多","","","","","","" },
            {"无","规模较小","规模中等","规模较大","重要","","","","",""},
/*4.1*/            {"＜6","6-15","15-30","30-45","45-60","60-150","150-250","250-300","300-450","≥450"},
            {"＜10","10-30","30-50","50-100","≥100","","","","",""},
            {"圆形外凸结构","矩形结构","存在凹角的结构","圆形内凹结构","","","","","",""},
            {"无","＜1.5","1.5-3","3-4.5","≥4.5","","","","",""},
            {"独立的","主体建筑外围且被分隔","主体建筑外围但不分隔","主体建筑内","紧邻忙碌区域","","","","","" },
            {"无/独立的建筑","主体建筑外围","建筑内但被分隔","紧邻资产","建筑物下","","","","","" },
            {"无","有","","","","","","","","" },
            {"无","紧邻建筑且位于地上","紧邻关键设施","紧邻忙碌区域","","","","","","" },
/*5.1*/            {"几乎无窗","可开启式窗格","金属框架","带状","点支式","","","","","" },
            {"≥12","＜12","","","","","","","","" },
            {"＜20%","20%-40%","40%-60%","60%-80%","≥80%","","","","","" },
            {"夹层玻璃","贴安全膜窗户","钢化玻璃","热强化玻璃","退火玻璃","","","","","" },
            {"现浇混凝土结构","幕墙结构","预制墙板/配筋砌体结构","大体积未加固砌体结构","轻框架/细长未加固的砌体","","","","","" },
            {"经过风载碎片防护设计","未经过风载碎片防护设计","","","","","","","","" },
/*6.1*/           {"钢筋混凝土剪力墙/管束结构","含支撑框架结构","核心混凝土筒框架结构","预制立墙平浇，或框架内填，或配筋砌体，或带桁架","轻钢框架/砖砌/木结构","","","","","" },
            {"≥5","3-5","＜3","","","","","","","" },
            {"＜5","5-7.5","7.5-10","10-20","≥20","","","","","" },
            {"＜3","3-7","7-12","≥12","","","","","","" },
            {"无","有，较粗","有，较细","","","","","","","" },
            {"无","上承一根柱的内部梁","上承超过一根柱的内部梁","上承一根柱的外部梁","上承超过一根柱的外部梁","","","","","" },
            {"抗爆设计","抗震抗风设计","无","采用旧规范设计","无针对偶然荷载的设计","","","","","" },
/*7.1*/            {"超过10m或在屋顶","3m-10m","地上不超过3m","位于地面","地下区域","","","","","" },
            {"管道形式，且难以接触","管道形式，但可接触","非管道形式","浮力驱动","","","","","","" },
            {"隔离高风险区域","多分区、单一系统管道结构","单一系统非管道结构","","","","","","","" },
            {"否","是","","","","","","","","" },
/*8.1*/           {"至少3个系统","2个系统","1个系统","无","","","","","","" },
           {"有效性高","有效","满足最低要求","无效","不安全的","","","","","" },
           {"至少3个系统","2个系统","1个系统","无","","","","","","" },
           {"有效性高","有效","满足最低要求","无效","不安全的","","","","","" },
           {"至少3个系统","2个系统","1个系统","无","","","","","","" },
           {"有效性高","有效","满足最低要求","无效","不安全的","","","","","" },
           {"至少3个系统","2个系统","1个系统","无","","","","","","" },
           {"有效性高","有效","满足最低要求","无效","不安全的","","","","","" },
           {"至少3个系统","2个系统","1个系统","无","","","","","","" },
           {"有效性高","有效","满足最低要求","无效","不安全的","","","","","" },
        };
        public static double[,,] numitem = new double[itemnum, 9, choicenum]
        {
/*3.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.06, 0.46,0.53,0.58,0.63,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*3.2*/             { { 0.03, 0.22,0.25,0.28,0.30,0,0,0,0,0 },
              { 0.01, 0.08,0.09,0.1,0.11,0,0,0,0,0 },
              { 0.01, 0.08,0.09,0.1,0.11,0,0,0,0,0 },
              { 0.03, 0.23,0.26,0.29,0.31,0,0,0,0,0},
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.15,0.17,0.19,0.2,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*3.3*/             { { 0.06, 0.45,0.51,0.57,0.60,0,0,0,0,0 },
              { 0.01, 0.08,0.09,0.1,0.11,0,0,0,0,0 },
              { 0.01, 0.08,0.09,0.1,0.11,0,0,0,0,0 },
              { 0.02, 0.12,0.13,0.15,0.16,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.15,0.17,0.19,0.2,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*3.4*/            { { 0.24, 1.77,2.13,2.4,0,0,0,0,0,0 },
              { 0.09, 0.63,0.76,0.86,0,0,0,0,0,0 },
              { 0.09, 0.63,0.76,0.86,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*3.5*/            { { 0.06, 0.45,0.54,0.60,0,0,0,0,0,0 },
              { 0.04, 0.32,0.38,0.43,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.12,0.14,0.16,0,0,0,0,0,0 },
              { 0.01, 0.06,0.07,0.08,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*3.6*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.1, 0.72,0.83,0.91,0.98,0,0,0,0,0 },
              { 0.09, 0.67,0.77,0.84,0.91,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.10,0.13,0.15,0.16,0.16,0.17,0.17,0.17,0.176 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.01, 0.07,0.09,0.11,0.12,0.12,0.12,0.12,0.13,0.128 },//0.128?
              { 0.01, 0.07,0.09,0.11,0.12,0.12,0.12,0.12,0.13,0.128 },//0.128?
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.09,0.12,0.13,0.15,0.15,0.15,0.15,0.16,0.16 },
              { 0.02, 0.09,0.12,0.13,0.15,0.15,0.15,0.15,0.16,0.16 },
              { 0.07, 0.41,0.52,0.59,0.65,0.67,0.68,0.70,0.71,0.72 }
            },
/*4.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0.03,0.04,0.04,0.044,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0.02,0.03,0.03,0.032,0,0,0,0,0 },
              { 0, 0.02,0.03,0.03,0.032,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0.03,0.03,0.04,0.04,0,0,0,0,0 },
              { 0, 0.03,0.03,0.04,0.04,0,0,0,0,0 },
              { 0.02, 0.13,0.15,0.17,0.18,0,0,0,0,0 }
            },
/*4.3*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.01, 0.08,0.10,0.11,0,0,0,0,0,0 },
              { 0.01, 0.08,0.10,0.11,0,0,0,0,0,0 },
              { 0.03, 0.23,0.28,0.31,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.4*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.23,0.20,0.29,0.31,0,0,0,0,0 },
              { 0.02, 0.12,0.13,0.15,0.16,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.5*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.6*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0.01, 0.06,0.07,0.07,0.08,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.7*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.06, 0.63,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*4.8*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.38,0.43,0,0,0,0,0,0 },
              { 0.07, 0.52,0.63,0.71,0,0,0,0,0,0 },
              { 0.01, 0.06,0.07,0.08,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*5.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.06, 0.46,0.53,0.58,0.63,0,0,0,0,0 },
              { 0.13, 0.96,1.10,1.21,1.3,0,0,0,0,0 },
              { 0.13, 0.96,1.10,1.21,1.3,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*5.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.31,0,0,0,0,0,0,0,0 },
              { 0.07, 0.67,0,0,0,0,0,0,0,0 },
              { 0.07, 0.67,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*5.3*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.26,0.3,0,0,0,0,0 },
              { 0.07, 0.49,0.57,0.62,0.67,0,0,0,0,0 },
              { 0.13, 0.96,1.10,1.21,1.3,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.26,0.3,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.26,0.3,0,0,0,0,0 },
              { 0.05, 0.37,0.42,0.46,0.5,0,0,0,0,0 },
            },
/*5.4*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.23,0.26,0.29,0.31,0,0,0,0,0 },
              { 0.06, 0.46,0.53,0.58,0.63,0,0,0,0,0 },
              { 0.13, 0.96,1.10,1.21,1.3,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*5.5*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.23,0.26,0.29,0.31,0,0,0,0,0 },
              { 0.07, 0.49,0.57,0.62,0.67,0,0,0,0,0 },
              { 0.07, 0.49,0.57,0.62,0.67,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.28,0.3,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.28,0.3,0,0,0,0,0 },
              { 0.03, 0.22,0.25,0.28,0.3,0,0,0,0,0 },
            },
/*5.6*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.16,0,0,0,0,0,0,0,0 },
              { 0.03, 0.31,0,0,0,0,0,0,0,0 },
              { 0.07, 0.67,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.23,0.26,0.29,0.31,0,0,0,0,0 },
              { 0.07, 0.49,0.57,0.62,0.67,0,0,0,0,0 },
              { 0.07, 0.49,0.57,0.62,0.67,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.35,0.43,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.3*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.36,0.40,0.43,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.24,0.28,0.31,0.33,0,0,0,0,0 },
              { 0.03, 0.24,0.28,0.31,0.33,0,0,0,0,0 },
              { 0.03, 0.24,0.28,0.31,0.33,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.4*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.32,0.38,0.43,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.24,0.29,0.33,0,0,0,0,0,0 },
              { 0.03, 0.24,0.29,0.33,0,0,0,0,0,0 },
              { 0.03, 0.24,0.29,0.33,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.5*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.35,0.43,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0.03, 0.27,0.33,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.6*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.09, 0.63,0.73,0.80,0.86,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.06,0.46,0.53,0.58,0.63,0,0,0,0,0 },
              { 0.13, 0.96,1.10,1.21,1.3,0,0,0,0,0 },
              { 0.07, 0.51,0.58,0.64,0.69,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*6.7*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.09, 0.63,0.73,0.80,0.86,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.06,0.46,0.53,0.58,0.63,0,0,0,0,0 },
              { 0.10, 0.77,0.88,0.97,1.04,0,0,0,0,0 },
              { 0.11, 0.81,0.93,1.02,1.1,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*7.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.24,0.27,0.30,0.32,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.37, 2.73,3.12,3.43,3.7,0,0,0,0,0 },
              { 0.62, 4.57,5.23,5.76,6.2,0,0,0,0,0 },
              { 0.53, 3.91,4.47,4.92,5.3,0,0,0,0,0 },
            },
/*7.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.12, 0.85,1.02,1.15,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.15, 1.09,1.31,1.48,0,0,0,0,0,0 },
              { 0.3, 2.21,2.66,3.00,0,0,0,0,0,0 },
              { 0.3, 2.21,2.66,3.00,0,0,0,0,0,0 },
            },
/*7.3*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.12, 0.93,1.15,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*7.4*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.04, 0.43,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.02, 0.16,0,0,0,0,0,0,0,0 },
              { 0.02, 0.16,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*8.1.1*/            { { 0.12, 0.90,1.08,1.216,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
            { { 0.49, 3.58,4.10,4.52,4.884,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*8.1.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.05, 0.39,0.48,0.536,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.21, 1.58,1.81,1.99,2.144,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*8.1.3*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.09, 0.65,0.78,0.884,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.35, 2.61,2.98,3.28,3.536,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*8.2.1*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.03, 0.22,0.26,0.294,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.12, 0.87,0.99,1.09,1.176,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
/*8.2.2*/            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.07, 0.53,0.64,0.724,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
            { { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0.29, 2.13,2.44,2.69,2.896,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
              { 0, 0,0,0,0,0,0,0,0,0 },
            },
        };
        string[] mentaryitem = new string[itemnum]
        /*条目解释*/
        {
            "从建筑立面到可能构成威胁的车辆的最短距离（单位：m）",
            "将建筑周围的场地与可能构成威胁的车辆的出入分隔开的障碍",
            "无障碍视野是指建筑物周围可用于对潜在犯罪活动进行反监视的最小距离（单位：m）",
            "不安全地下通道是指穿过周边和/或地下室的各种入口",
            "储存危险品的设施类型",
            "指该建筑附近的其他非业主控制的结构",
            "建筑高度，与建筑信息页一致（单位：m）",
            "建筑面积与占地面积的比值；与占地面积大的低层建筑相比，高层建筑往往更容易在恐怖袭击后发生连续性倒塌，与建筑信息页一致",
            "凹面往往会捕获冲击波，并由于多次反射而放大空气冲击的效果",
            "如果悬挑上方的楼层未被占用或具有关键功能，则应选择选项“a”（单位：m）",
            "建筑物的公共区域被视为高风险区域，这些空间相对于关键区域或主要结构的位置会影响建筑物易受爆炸袭击的程度",
            "装货码头、邮件安检区被视为高风险区域，爆炸物或CBR威胁可能在未被发现的情况下被运进建筑物",
            "场地的所有侧面都采用了防撞击的措施来避免高速车辆的撞击",
            "车库是一个特别高风险的区域，未经安检或安检的车辆可能会在这里运送武器",
            "窗户支撑类型是指将典型窗户连接到外部围护结构和结构中的方式",
            "窗户玻璃的夹持深度（单位：mm）",
            "窗户面积占总墙壁面积的比例",
            "玻璃类型",
            "墙体类型",
            "是否有碎片防护设计",
            "结构系统使建筑物能够支撑其自身重量、内容物的重量并抵抗风和地震引起的荷载",
            "“开间”是指两个柱子之间的空间",
            "柱间距或结构开间尺寸是沿每个主方向的柱中心线或承重墙之间的距离（单位：m）",
            "柱高度是指未通过楼板系统或梁在两个方向上支撑的柱的高度（单位：m）",
            "可供公众使用的立柱易受爆炸物装载的影响",
            "转换梁通常是支撑上方不连续柱的大跨度梁",
            "有助于提高或降低结构系统或单个构件（如板、梁和柱）性能的增强或削弱",
            "有毒气体被引入建筑物空气系统的可能性取决于建筑物外部进气口的可达性（单位：m）",
            "回风系统是否为管道系统，管道回风比无管道或增压空气系统更不容易受到影响",
            "建筑物内的大厅、装卸码头、邮件室和零售空间等高风险区域有可能将有毒气体引入内部空气分配系统",
            "保护关键公用设施将有助于减轻火灾等事件后的危险，并加快应急响应人员的疏散和搜救工作",
            "冗余的检测系统是非常必要的",
            "该特性旨在集中体现系统的整体有效性",
            "冗余的检测系统是非常必要的",
            "该特性旨在集中体现系统的整体有效性",
            "冗余的检测系统是非常必要的",
            "该特性旨在集中体现系统的整体有效性",
            "冗余的检测系统是非常必要的",
            "该特性旨在集中体现系统的整体有效性",
            "冗余的检测系统是非常必要的",
            "该特性旨在集中体现系统的整体有效性"
        };


        private void frmVulnerability_Load(object sender, EventArgs e)
        {
            Function.Load(this, itemnum, choicenum, name, nameitem, lblmentary, ttp, mentaryitem, choice, choiceitem, txt, sumvul);
            for (int i = 0; i < errornum; i++)
                labelerror[i] = new Label();
            labelerror[0].Top = 285;
            labelerror[0].Left = 315;
            labelerror[0].Height = 20;
            labelerror[0].ForeColor = Color.Red;
            labelerror[1].Top = 315;
            labelerror[1].Left = 315;
            labelerror[1].Height = 20;
            labelerror[1].ForeColor = Color.Red;
            for (int i = 0; i < errornum; i++)
                this.Controls.Add(labelerror[i]);
        }

        private void check_intdata(ComboBox[] choice, Label[] labelerror)
        {
            int i, j;
            //建筑高度
            double standard1 = double.Parse(frmInformation.check_text[7]);
            int sample1 = choice[6].SelectedIndex;
            double[] library1 = new double[10] { 0, 6, 15, 30, 45, 60, 150, 250, 300, 450 };
            for (i = 0; i < 9; i++)
            {
                if ((standard1 >= library1[i] && standard1 < library1[i + 1]) || (standard1 >= library1[9]))
                {
                    if (sample1 == i)
                        labelerror[0].Text = "";
                    else
                        labelerror[0].Text = "!";
                }
            }
            //建筑面积÷占地面积
            double standard2;
            if (double.Parse(frmInformation.check_text[10]) != 0)
                standard2 = double.Parse(frmInformation.check_text[9]) / double.Parse(frmInformation.check_text[10]);
            else
                standard2 = 0;
            int sample2 = choice[7].SelectedIndex;
            double[] library2 = new double[5] { 0,10,30,50,100 };
            for (i = 0; i < 4; i++)
            {
                if ((standard2 >= library2[i] && standard2 < library2[i + 1]) || (standard2 >= library2[4]))
                {
                    if (sample2 == i)
                        labelerror[1].Text = "";
                    else
                        labelerror[1].Text = "!";
                }
            }

        }


        private void btnOK_Click(object sender, EventArgs e)
        {
            Function.OK(txt, sumvul, choice, numitem, itemnum, sumvuldata);
            check_intdata(choice, labelerror);
        }


    }

}
